<div class="gray-bg">
    <div class="container-fluid">
        <div class="row">
          <div class="wave-loader" *ngIf="showLoading">
              <div class="wave-loading"></div>
            </div>
        </div>
      </div>
      <div class="container-fluid" *ngIf="!empty; else elseBlock">
        <div class="row" style="padding-top: 50px; padding-bottom: 50px;">
          <div class="col-md-9"></div>
          <div class="col-md-3 text-right">
            <a routerLink="/home" class="btn-red-a">{{'Cart.back' | translate}}</a>
          </div>
        </div>
        <div class="table-design">
          <div class="row row-bg" *ngFor="let product of products; index as i;">
            <div class="col">
              <div class="box-input">
                <input type="number" [value]="product.quantity.value" [(ngModel)]="product.quantity.value"(change)="validateMax(i)">
              </div>
            </div>
            <div class="col text-center" *ngIf="product.fish.type">
                {{product?.fish?.type?.name}}
            </div>
            <div class="col">
              @ {{product.price.value | currency: 'AED'}} / kg
            </div>
            <div class="col">
              <div class="product-name">
                <a routerLink="/product/{{product.fish.id}}">{{product.fish.name}}</a>
                <hr class="black-line">
              </div>
              <div class="product-description">
                {{product.fish.description}}
              </div>
              <div class="store-details">
                <p> <a style="color: #585656;" routerLink="/store/{{product.fish.store.id}}" target="_blank"> <img *ngIf="product.fish.store.logo != ''" width="100px" src="{{API}}{{product?.fish?.store?.logo}}" alt="">{{product?.fish?.store?.name}}</a></p>
              </div>
            </div>
            <div class="col" *ngIf="product.fish.country != ''">
              Shipping from {{findCountryName(product?.fish?.country)}}
            </div>
            <div class="col text-center">
              {{getTotalxItem(product.quantity.value, product.price.value) | currency: 'AED'}}
            </div> 
            <div class="col">
              <button class="pink-btn btn-rm" (click)="showConfirmModal(product.id)"> {{'Cart.delete' | translate}}</button>
            </div>
          </div>
        </div>
        <div class="row" >
            <div class="col-md-12" style="padding-bottom: 20px;">
              <hr class="cart-divider">
            </div>
            <div class="col-md-3">
              <button class="pink-btn" (click)="getAllProductsCount()">{{'Cart.update' | translate}}</button>
            </div>
            <div class="col-md-7 text-right">
            </div>
            <div class="col-md-6"></div>
            <div class="col-md-6" style="padding-bottom: 20px; padding-top: 20px;">
              <div class="cart-totals">
                <h3>Cart Totals</h3>
                <table>
                  <tr>
                    <td><b>Subtotal</b></td>
                    <td>{{(total) | currency: 'AED'}} </td>
                  </tr>
                  <tr>
                    <td><b>Taxes, Customs and Other Fees</b></td>
                    <td>{{(totalOtherFees) | currency: 'AED'}}</td>
                  </tr>
                  <tr>
                    <td><b>Shipping</b></td>
                    <td>{{(shipping) | currency: 'AED'}}</td>
                  </tr>
                  <tr>
                    <td><b>Total</b></td>
                    <td><b>{{(totalWithShipping) | currency: 'AED'}} </b></td>
                  </tr>
                </table>
                
              </div>
              <button class="btn-red" (click)="checkout()">Proceed to checkout</button>
            </div>
        </div>
      
      </div>
      
      <div class="modal fade" id="confirmDelete" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Delete Product</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <div class="row">
                <div class="col">											
                    <h4>Are you sure you would like to delete?</h4>
                    <button type="button" (click)="deleteItem( index, itemToDelete )" class="btn-red-a btn-yes">Yes</button>						
                </div>					
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <ng-template #elseBlock>
        
          <div class="container-fluid empty-container">
            <div class="row">
              <div class="col-lg-12 text-center">
                <img src="../../assets/svg/undraw_empty_xct9.svg" alt="">
                <h4>YOUR CART IS EMPTY</h4>
                <button class="outline-btn" routerLink="/shop">
                  continue shopping
                </button>
              </div>
            </div>
          </div>  
        </ng-template>
</div>
