<div class="bg">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <h2 class="black-title">{{'ManageOrders.title' | translate}}</h2>
      </div>
    </div>
      <div class="row">
        <div class="col-md-3">
            <div class="form-group" >
                <label>{{'ManageOrders.status' | translate}}</label>
                <select class="form-control" name="status" [(ngModel)]="status" (change)="getOrders()" [value]='0' >
                    <option value="0" selected="selected">Select an Option</option>
                    <option *ngFor="let item of orderStatus;"  [ngValue]="item.id"> {{item.status}}</option>
                </select>
              </div>
          
        </div>
          <div class="col-3">
            <div class="form-group" >
              <label>{{'ManageOrders.orderNumber' | translate}}</label>
              <input type="text" class="form-control" [(ngModel)]="orderNumber" (keyup.enter)="getOrders()"  placeholder="search by Order Number">
            </div>
          </div>
          <div class="col-3">
            <button class="pink-btn" (click)="clear()">Clear filter</button>
          </div>
          <div class="col-3">
            <a class="pink-btn" href="http://13.232.68.135/xero/connect">Push All Orders to Xero</a>
          </div>
          <div class="col-12 table-design" style="margin-top: 20px; margin-bottom: 20px" *ngIf="!showNoData">
            <div class="row row-bg" *ngFor="let order of groupOrder">
              <div class="col-4">
                <p class="order-number">Order #{{order.orderNumber}}</p>
                <p *ngIf="order.xeroRef" class="order-number">Xero Ref: #{{order.xeroRef}}</p>
              </div>
              <div class="col-8">
                 <div class="row" *ngFor="let item of orderWithData">
                  <div class="col-6">
                    <ng-container *ngIf="item.shoppingCart!==null&&item.shoppingCart!==undefined? item.shoppingCart.orderNumber==order.orderNumber : false">
                      <h5 [innerHtml]="item.fish.name"></h5>                
                      <span *ngIf="item.store" class="store">{{item.store.name}}</span>               
                      <p *ngIf="item.status" class="status"><b>Status: </b>{{item.status.status}}</p>
                      
                      <p class="buyer"><b>Buyer Maximum Delivery Date: </b>{{item.buyerExpectedDeliveryDate}}</p>
                      <p class="seller"><b>Seller Expected Delivery Date: </b>{{item.sellerExpectedDeliveryDate}}</p>
                      
                      <p class="qty">Quantity {{item.quantity.value}} kg</p>  
                      <p class="total">Total: {{((item.quantity.value * item.price.value ) + item.shipping + item.customs + item.uaeTaxes + item.sfsMargin) | currency:'AED'}}</p>
                    </ng-container>
                    
                  </div>
                  <div class="col-6">
                    <!-- <ng-container *ngIf="item.shoppingCart.orderNumber==order.orderNumber">
                      <div *ngIf="item.updateInfo">
                        <p class="date" *ngFor="let update of item.updateInfo;" >
                          <strong>{{update.action}} on {{update.at*1000 | date: 'EEEE, MMMM d, y, HH:mm'}} <br> by {{update.by}} </strong>
                        </p>
                      </div>
                    </ng-container> -->
                    <ng-container  *ngIf="validateUpdateInfo(item, order)">
                      <div class="information-log">
                        <i class="fa fa-info-circle" aria-hidden="true"></i>
                        <div class="info-modal-log">
                          
                            <div *ngIf="item.updateInfo">
                              <p class="date" *ngFor="let update of item.updateInfo;" >
                                <strong>{{update.action}} on {{update.at*1000 | date: 'EEEE, MMMM d, y, HH:mm'}} <br> by {{update.by}} </strong>
                              </p>
                            </div>
                          
                        </div>
                      </div>
                    </ng-container>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12" *ngIf="showNoData" style="margin-bottom: 20px;">
            <h2 class="black-title">No records found</h2>
          </div>
        </div>
      
  </div>
  </div>